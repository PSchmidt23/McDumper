(this.webpackJsonpmcdumper=this.webpackJsonpmcdumper||[]).push([[0],{22:function(e,t,a){e.exports=a(37)},29:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(17),c=a.n(l),s=a(3),i=a(12),o=a(18),u=a(10),m=a(8),p=a(11);const b=Object(o.a)({apiKey:"AIzaSyB8w6Hrwq6WsZDrZQz0ZqM-0bnr6geOy2A",authDomain:"mcdumper-36b77.firebaseapp.com",projectId:"mcdumper-36b77",storageBucket:"mcdumper-36b77.appspot.com",messagingSenderId:"848104218864",appId:"1:848104218864:web:79e96e7acdacec894b2235"}),d=Object(u.b)(b),f=Object(m.c)(b),E=Object(p.b)(b),g=Object(r.createContext)(),h=e=>{let{children:t}=e;const[a,l]=Object(r.useState)(null),[c,s]=Object(r.useState)(!0),[i,o]=Object(r.useState)(null);return Object(r.useEffect)(()=>{const e=Object(u.c)(d,async e=>{if(e){const a=Object(m.a)(f,"users",e.uid);try{const t=Object(m.d)(a,t=>{if(t.exists()){const a=t.data(),r=!a.displayName||""===a.displayName.trim()||!a.email||""===a.email.trim();l({...e,...a,isNewUser:r})}else{const t=!0;Object(m.f)(a,{uid:e.uid,phoneNumber:e.phoneNumber||"",email:e.email||"",displayName:"",profilePicture:"",instagram:"",createdAt:Object(m.e)()}),l({...e,isNewUser:t})}});return()=>{t()}}catch(t){console.error("Error fetching user data:",t.code,t.message),o(t),l(null)}finally{s(!1)}}else l(null),s(!1)});return()=>{e()}},[]),c?n.a.createElement("p",null,"Loading..."):i?n.a.createElement("p",null,"Error: ",i.message):n.a.createElement(g.Provider,{value:{currentUser:a}},t)};a(29);var O=()=>{const e=Object(s.p)();return n.a.createElement("div",{className:"welcome-container"},n.a.createElement("h1",{className:"app-title"},"McDumper"),n.a.createElement("div",{className:"caption-and-button"},n.a.createElement("p",{className:"app-caption"},"Best Place to Dump"),n.a.createElement("button",{className:"get-started-button",onClick:()=>{e("/sign-in")},"aria-label":"Get Started"},"Get Started")))},y=a(19),j=a.n(y),N=(a(30),a(31),a(7));var v=()=>{const{currentUser:e}=Object(r.useContext)(g),t=Object(s.p)(),[a,l]=Object(r.useState)(""),[c,i]=Object(r.useState)(""),[o,m]=Object(r.useState)(null),[p,b]=Object(r.useState)(!1),[f,E]=Object(r.useState)(!1);Object(r.useEffect)(()=>{e&&(e.isNewUser?t("/profile-setup"):t("/profile"))},[e,t]);return n.a.createElement("div",{className:"phone-auth-container"},n.a.createElement("h2",null,"Sign In / Sign Up"),o?n.a.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),c){E(!0);try{await o.confirm(c),N.b.success("Phone number verified successfully!")}catch(t){console.error("Error verifying OTP",t.code,t.message),N.b.error("Invalid OTP. Please try again.")}finally{E(!1)}}else N.b.error("Please enter the OTP.")},className:"auth-form"},n.a.createElement("input",{type:"text",placeholder:"Enter OTP",value:c,onChange:e=>i(e.target.value),className:"otp-input"}),n.a.createElement("button",{type:"submit",disabled:f,className:"auth-button"},f?"Verifying OTP...":"Verify OTP")):n.a.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),!a)return void N.b.error("Please enter your phone number.");b(!0),window.recaptchaVerifier||(window.recaptchaVerifier=new u.a("recaptcha-container",{size:"invisible",callback:e=>{console.log("reCAPTCHA solved")},"expired-callback":()=>{console.warn("reCAPTCHA expired")}},d));const t=window.recaptchaVerifier;try{console.log("Formatted phone number:","+"+a);const e=await Object(u.d)(d,"+"+a,t);m(e),N.b.success("OTP has been sent to your phone.")}catch(r){console.error("Error during signInWithPhoneNumber",r.code,r.message),N.b.error("Failed to send OTP. Please try again."),window.recaptchaVerifier&&(window.recaptchaVerifier.clear(),window.recaptchaVerifier=null)}finally{b(!1)}},className:"auth-form"},n.a.createElement(j.a,{country:"us",value:a,onChange:e=>l(e),inputStyle:{width:"100%"},countryCodeEditable:!1,placeholder:"Enter phone number"}),n.a.createElement("button",{type:"submit",disabled:p,className:"auth-button"},p?"Sending OTP...":"Send OTP")),n.a.createElement("div",{id:"recaptcha-container"}))},P=(a(32),a(38));var S=()=>{const{currentUser:e}=Object(r.useContext)(g),t=Object(s.p)(),[a,l]=Object(r.useState)(""),[c,o]=Object(r.useState)(""),[b,h]=Object(r.useState)(""),[O,y]=Object(r.useState)(null),[j,N]=Object(r.useState)(""),[v,S]=Object(r.useState)("");Object(r.useEffect)(()=>{e&&(async()=>{const t=Object(m.a)(f,"users",e.uid),a=await Object(m.b)(t);if(a.exists()){const e=a.data();l(e.displayName||""),o(e.email||""),h(e.instagram||""),N(e.profilePicture||"")}})()},[e]);return n.a.createElement("div",{className:"dashboard-container"},n.a.createElement("h2",null,"Welcome to Your Dashboard!"),e&&n.a.createElement("p",null,"Signed in as: ",n.a.createElement("strong",null,e.phoneNumber)),v&&n.a.createElement("p",{className:"message"},v),n.a.createElement("form",{onSubmit:async t=>{if(t.preventDefault(),S(""),a.trim())if(!c||/\S+@\S+\.\S+/.test(c))try{let t=j;if(O){const a=Object(p.c)(E,`profilePictures/${e.uid}/${Object(P.a)()}`);await Object(p.d)(a,O),t=await Object(p.a)(a)}const r=Object(m.a)(f,"users",e.uid);await Object(m.g)(r,{displayName:a,email:c,instagram:b,profilePicture:t}),S("Profile updated successfully!")}catch(r){console.error("Error updating profile:",r),S("Failed to update profile.")}else S("Please enter a valid email address.");else S("Display Name cannot be empty.")},className:"profile-form"},n.a.createElement("input",{type:"text",placeholder:"Display Name",value:a,onChange:e=>l(e.target.value)}),n.a.createElement("input",{type:"email",placeholder:"Email Address",value:c,onChange:e=>o(e.target.value)}),n.a.createElement("input",{type:"text",placeholder:"Instagram Username",value:b,onChange:e=>h(e.target.value)}),n.a.createElement("input",{type:"file",accept:"image/*",onChange:e=>{y(e.target.files[0])}}),n.a.createElement("button",{type:"submit",className:"auth-button"},"Update Profile")),n.a.createElement(i.b,{to:"/profile/"+e.uid,className:"profile-link"},"View Your Profile"),n.a.createElement("button",{onClick:async()=>{try{await Object(u.e)(d),t("/sign-in")}catch(e){console.error("Error signing out:",e)}},className:"sign-out-button"},"Sign Out"))},w=a(20);a(33);var C=()=>{const{currentUser:e}=Object(r.useContext)(g),t=Object(s.p)();return e?n.a.createElement("div",{className:"profile-page-container"},n.a.createElement("div",{className:"profile-header"},n.a.createElement("h2",null,"Your Profile"),n.a.createElement("button",{onClick:async()=>{try{await Object(u.e)(d),N.b.success("Signed out successfully."),t("/sign-in")}catch(e){console.error("Error signing out:",e.code,e.message),N.b.error("Failed to sign out. Please try again.")}},className:"settings-button",title:"Settings & Sign Out"},n.a.createElement(w.a,{size:24}))),n.a.createElement("div",{className:"profile-info"},e.profilePicture?n.a.createElement("img",{src:e.profilePicture,alt:"Profile",className:"profile-picture"}):n.a.createElement("div",{className:"profile-picture-placeholder"},"No Image"),n.a.createElement("p",null,n.a.createElement("strong",null,"Name:")," ",e.displayName||"N/A"),n.a.createElement("p",null,n.a.createElement("strong",null,"Phone Number:")," ",e.phoneNumber||"N/A"),n.a.createElement("p",null,n.a.createElement("strong",null,"Email:")," ",e.email||"N/A"),n.a.createElement("p",null,n.a.createElement("strong",null,"Instagram:")," ",e.instagram||"N/A"))):n.a.createElement("p",null,"Loading...")};a(34);var x=()=>{const{currentUser:e}=Object(r.useContext)(g),t=Object(s.p)(),[a,l]=Object(r.useState)(""),[c,i]=Object(r.useState)(""),[o,u]=Object(r.useState)(""),[b,d]=Object(r.useState)(null),[h,O]=Object(r.useState)(!1);return n.a.createElement("div",{className:"profile-setup-container"},n.a.createElement("h2",null,"Complete Your Profile"),n.a.createElement("form",{onSubmit:async r=>{if(r.preventDefault(),a.trim()){O(!0);try{console.log("Starting profile setup...");const r=Object(m.a)(f,"users",e.uid);let n=e.profilePicture||"";if(b){const t=Object(p.c)(E,`profilePictures/${e.uid}/${Object(P.a)()}`);await Object(p.d)(t,b),n=await Object(p.a)(t),console.log("Profile picture uploaded:",n)}await Object(m.g)(r,{displayName:a,email:c,instagram:o,profilePicture:n}),console.log("User document updated successfully."),N.b.success("Profile setup complete!"),t("/profile")}catch(n){console.error("Error setting up profile:",n.code,n.message),N.b.error("Failed to set up profile. Please try again.")}finally{O(!1)}}else N.b.error("Display Name is required.")},className:"profile-form"},n.a.createElement("input",{type:"text",placeholder:"Display Name",value:a,onChange:e=>l(e.target.value),required:!0}),n.a.createElement("input",{type:"email",placeholder:"Email Address",value:c,onChange:e=>i(e.target.value)}),n.a.createElement("input",{type:"text",placeholder:"Instagram Username",value:o,onChange:e=>u(e.target.value)}),n.a.createElement("input",{type:"file",accept:"image/*",onChange:e=>{d(e.target.files[0])}}),n.a.createElement("button",{type:"submit",disabled:h,className:"auth-button"},h?"Processing...":"Next")))};a(35);const U=e=>{let{children:t}=e;const{currentUser:a}=Object(r.useContext)(g);return a?t:n.a.createElement(s.a,{to:"/sign-in"})};var A=function(){return n.a.createElement(h,null,n.a.createElement(i.a,null,n.a.createElement(N.a,null)," ",n.a.createElement(s.d,null,n.a.createElement(s.b,{path:"/",element:n.a.createElement(O,null)}),n.a.createElement(s.b,{path:"/sign-in",element:n.a.createElement(v,null)}),n.a.createElement(s.b,{path:"/dashboard",element:n.a.createElement(U,null,n.a.createElement(S,null))}),n.a.createElement(s.b,{path:"/profile-setup",element:n.a.createElement(U,null,n.a.createElement(x,null))}),n.a.createElement(s.b,{path:"/profile",element:n.a.createElement(U,null,n.a.createElement(C,null))}),n.a.createElement(s.b,{path:"*",element:n.a.createElement(s.a,{to:"/"})}))))};a(36);c.a.createRoot(document.getElementById("root")).render(n.a.createElement(A,null))}},[[22,1,2]]]);
//# sourceMappingURL=main.79228e04.chunk.js.map